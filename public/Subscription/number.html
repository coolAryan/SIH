<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Suscribe</title>
          <link rel="stylesheet" href="sub.css">  
		  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    </head>
    <body>
<div class="wrapper">
	<div class="container">
		<h2>Enter PhoneNumber To Subscribe</h2>
		<form class="form" action="/subscribeByNumber" method="post">
			<input type="tel" class="phoneNumber" name="phoneNumber" placeholder="Phone Number" pattern="[0-9]{10}" maxlength="10"  title="Ten digits code" required/>
			<button type="number" id="otp-button">Generate OTP</button>
		</form>
		<br><br>
		<form action="/subscribeByNumber" method="post">
            <input type="tel" name="otp" placeholder="otp" maxlength="8"  title="Five-Eight digits code" required/>
            <button type="submit" id="verify-button">Verify</button><br>
		</form>
	</div>
	
	<ul class="bg-bubbles">
		<li></li>
		<li></li>
		<li></li>
		<li></li>
		<li></li>
		<li></li>
		<li></li>
		<li></li>
		<li></li>
		<li></li>
	</ul>
</div>
</body>
<script type="text/javascript">

   var phoneNumber = document.getElementsByClassName("phoneNumber").value;
   function runJsScript(phoneNumber){
        var jqXHR = $.ajax({
            type: "POST",
            url: "/subscribeByNumber",
            async: false,
            data: { phoneNumber: phoneNumber }
        });

        console.log(jqXHR.responseText);
        return jqXHR.responseText;
    }

    $('#otp-button').click(function(){ 
		console.log(phoneNumber);
        result = runJsScript(phoneNumber);
        console.log('Got back ' + result);
    }); 
</script>
</html>